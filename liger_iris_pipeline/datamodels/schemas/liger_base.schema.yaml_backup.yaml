%YAML 1.1
---
$schema: "http://stsci.edu/schemas/fits-schema/fits-schema"
id: "https://oirlab.github.io/schemas/liger_base.schema"
type: object
properties:
  meta:
    type: object
    properties:
      date:
        title: "UTC date file created"
        type: string
        fits_keyword: DATE
        blend_table: True
      origin:
        title: Organization responsible for creating file
        type: string
        fits_keyword: ORIGIN
        blend_table: True
      filename:
        title: Name of the file
        type: string
        fits_keyword: FILENAME
        blend_table: True
      data_processing_software_version:
        title: Data processing (DP) Software Version
        type: string
        fits_keyword: SDP_VER
        blend_table: True
      model_type:
        title: Type of data model
        type: string
        fits_keyword: DATAMODL
        blend_table: True
      telescope:
        title: Telescope used to acquire the data
        type: string
        fits_keyword: TELESCOP
        blend_table: True
      asn:
        title: Association information
        type: object
        properties:
          pool_name:
            title: Name of the ASN pool
            type: string
            fits_keyword: ASNPOOL
            blend_table: True
          table_name:
            title: Name of the ASN table
            type: string
            fits_keyword: ASNTABLE
            blend_table: True
          exptype:
            title: Exposure type provided for this exposure in the association
            type: string
            default: 'science'
      {program:{keck_program.schema.yaml}}
      target:
        title: Target information
        type: object
        properties:
          catalog_name:
            title: Standard astronomical catalog name for target
            type: string
            fits_keyword: TARGNAME
            blend_table: True
          type:
            title: Type of target (fixed, moving, generic)
            type: string
            fits_keyword: TARGTYPE
            blend_table: True
          category:
            title: Target category from APT
            type: string
            fits_keyword: TARGCAT
          description:
            title: Target description from APT
            type: string
            fits_keyword: TARGDESC
          ra:
            title: Target RA at mid time of exposure
            type: number
            fits_keyword: TARG_RA
            blend_table: True
          dec:
            title: Target Dec at mid time of exposure
            type: number
            fits_keyword: TARG_DEC
            blend_table: True
          ra_uncertainty:
            title: Target RA uncertainty
            type: number
            fits_keyword: TARGURA
            blend_table: True
          dec_uncertainty:
            title: Target Dec uncertainty
            type: number
            fits_keyword: TARGUDEC
            blend_table: True
          proper_motion_ra:
            title: Target proper motion in RA
            type: number
            fits_keyword: MU_RA
            blend_table: True
          proper_motion_dec:
            title: Target proper motion in Dec
            type: number
            fits_keyword: MU_DEC
            blend_table: True
          proper_motion_epoch:
            title: Target proper motion epoch
            type: string
            fits_keyword: MU_EPOCH
            blend_table: True
          source_type:
            title: Source type used for calibration
            type: string
            enum: [EXTENDED, POINT, UNKNOWN]
            fits_keyword: SRCTYPE
          prop_ra:
            title: Proposer's target RA
            type: number
            fits_keyword: PROP_RA
            blend_table: True
          prop_dec:
            title: Proposer's target Dec
            type: number
            fits_keyword: PROP_DEC
            blend_table: True
          prop_source_type:
            title: Source type from proposal.
            type: string
            enum: [EXTENDED, POINT, UNKNOWN]
            fits_keyword: SRCTYPPR
            blend_table: True
      instrument:
        title: Instrument configuration information
        type: object
        properties:
          name:
            title: Instrument used to acquire the data
            type: string
            enum: [Liger] # NOTE: Unsure if we should split between IFU/Imager here and/or below.
            fits_keyword: INSTRUME
            blend_table: True
          detector:
            title: Name of detector used to acquire the data
            type: string
            enum: [LIGERIMAGER, LIGERIFU, N/A, MULTIPLE] # NOTE: Shorten these in the future?
            fits_keyword: DETECTOR
            blend_table: True
            blend_rule: multi
          channel: # NOTE: Unsure if we should split between IFU/Imager here and/or above.
            title: Instrument channel
            type: string
            - enum:
              [IMAGER, IFU, N/A]
            fits_keyword: CHANNEL
            blend_table: True
            blend_rule: multi
          filter:
            title: Name of the filter element used
            type: string
            enum: [
              ANY, CLEAR, OPAQUE, N/A, MULTIPLE,
              Zbb, Ybb, Jbb, Hbb, Kbb,
              Z, Y, J, H, Ks, K,
              ZN1, ZN2, ZN3, ZN4,
              YN1, YN2, YN3,
              JN1, JN2, JN3, JN4,
              HN1, HN2, HN3, HN4, HN5,
              KN1, KN2, KN3, KN4, KN5,
              CaIIw, PaBetaw, FeIIw, Br_Gammaw, COw,
              HeI,
              Jcont,
              PaBeta,
              Hcont,
              FeII,
              H2one,
              Kcont,
              Br_Gamma,
              H2two,
              CO,
            ]
            fits_keyword: FILTER
            blend_table: True
            blend_rule: multi
          pupil:
            title: Name of the pupil element used
            type: string
            enum: [ANY, CLEAR, N/A]
            fits_keyword: PUPIL
            blend_table: True
          pupil_imaging_lens:
            title: Pupil imaging lens in the optical path?
            type: boolean
            fits_keyword: PILIN
            blend_table: True
          grating:
            title: Name of the grating element used
            type: string
            enum: [MIRROR, N/A, ANY, UNKNOWN, MULTIPLE] # NOTE: Add grating names here
            fits_keyword: GRATING
            blend_table: True
            blend_rule: multi
      exposure:
        title: Exposure parameters
        type: object
        properties:
          prime_parallel:
            title: Prime or parallel exposure
            type: string
            enum: [PRIME, PARALLEL_COORDINATED, PARALLEL_PURE]
            fits_keyword: EXPRIPAR
            blend_table: True
          type:
            title: Type of data in the exposure
            type: string
            # enum:
            #   # Liger IFU or Imager
            #  [
            #   # Misc
            #   N/A, ANY]
            fits_keyword: IMTYPE # NOTE: This may drive a lot of the pipeline logic
            blend_table: True
          start_time:
            title: "[d] exposure start time in MJD"
            type: number
            fits_keyword: EXPSTART
            blend_table: True
            blend_rule: min
          mid_time:
            title: "[d] exposure mid time in MJD"
            type: number
            fits_keyword: EXPMID
            blend_table: True
            blend_rule: mean
          end_time:
            title: "[d] exposure end time in MJD"
            type: number
            fits_keyword: EXPEND
            blend_table: True
            blend_rule: max
          start_time_tdb:
            title: "[d] TDB time of exposure start in MJD"
            type: number
            fits_keyword: TDB-BEG
            blend_table: True
            blend_rule: min
          mid_time_tdb:
            title: "[d] TDB time of exposure mid-point in MJD"
            type: number
            fits_keyword: TDB-MID
            blend_table: True
            blend_rule: mean
          end_time_tdb:
            title: "[d] TDB time of exposure end in MJD"
            type: number
            fits_keyword: TDB-END
            blend_table: True
            blend_rule: max
          readpatt:
            title: Readout pattern
            type: string
            #enum: []
            fits_keyword: READPATT
            blend_table: True
          nints:
            title: Number of integrations in exposure
            type: integer
            fits_keyword: NINTS
            blend_table: True
          integration_start:
            title: Starting integration number in this segment
            type: integer
            fits_keyword: INTSTART
            blend_table: True
            blend_rule: min
          integration_end:
            title: Ending integration number in this segment
            type: integer
            fits_keyword: INTEND
            blend_table: True
            blend_rule: max
          ngroups:
            title: Number of groups in integration
            type: integer
            fits_keyword: NGROUPS
            blend_table: True
          nframes:
            title: Number of frames per group
            type: integer
            fits_keyword: NFRAMES
            blend_table: True
          nsamples:
            title: Number of A/D samples per pixel
            type: integer
            fits_keyword: NSAMPLES
            blend_table: True
          sample_time:
            title: "[us] Time between samples"
            type: number
            fits_keyword: TSAMPLE
            blend_table: True
          frame_time:
            title: "[s] Time between frames"
            type: number
            fits_keyword: TFRAME
            blend_table: True
          group_time:
            title: "[s] Time between groups"
            type: number
            fits_keyword: TGROUP
            blend_table: True
          integration_time:
            title: "[s] Effective integration time"
            type: number
            fits_keyword: EFFINTTM
            blend_table: True
          exposure_time:
            title: "[s] Effective exposure time"
            type: number
            fits_keyword: EFFEXPTM
            blend_rule: sum
            blend_table: True
          effective_exposure_time:
            title: "[s] Effective exposure time"
            type: number
            fits_keyword: XPOSURE
            blend_rule: sum
            blend_table: True
          duration:
            title: "[s] Total duration of exposure"
            type: number
            fits_keyword: DURATION
            blend_rule: sum
            blend_table: True
          elapsed_exposure_time:
            title: "[s] Total elapsed exposure time"
            type: number
            fits_keyword: TELAPSE
            blend_rule: sum
            blend_table: True
          nresets_at_start:
            title: Number of resets at start of exposure
            type: integer
            fits_keyword: NRSTSTRT
            blend_table: True
          nresets_between_ints:
            title: Number of resets between integrations
            type: integer
            fits_keyword: NRESETS
            blend_table: True
          data_problem:
            title: Science telemetry indicated a problem
            type: boolean
            fits_keyword: DATAPROB
            blend_table: True
          gain_factor:
            title: Gain scale factor
            type: number
            fits_keyword: GAINFACT
            blend_table: True
      subarray:
        title: Subarray parameters
        type: object
        properties:
          name:
            title: Subarray used
            type: string
            enum: [FULL, CUSTOM, GENERIC, N/A]
            fits_keyword: SUBARRAY
            blend_table: True
          id:
            title: Subarray ID, 0 is full
            type: integer
            fits_keyword: SUBARRID
            blend_table: True
          xstart:
            title: Starting pixel in axis 1 direction
            type: integer
            fits_keyword: SUBSTRT1
            blend_table: True
          ystart:
            title: Starting pixel in axis 2 direction
            type: integer
            fits_keyword: SUBSTRT2
            blend_table: True
          xsize:
            title: Number of pixels in axis 1 direction
            type: integer
            fits_keyword: SUBSIZE1
            blend_table: True
          ysize:
            title: Number of pixels in axis 2 direction
            type: integer
            fits_keyword: SUBSIZE2
            blend_table: True
          fastaxis:
            title: Fast readout axis direction
            type: integer
            fits_keyword: FASTAXIS
            blend_table: True
          slowaxis:
            title: Slow readout axis direction
            type: integer
            fits_keyword: SLOWAXIS
            blend_table: True
          detxcor:
            title: Starting pixel in detector x-axis direction
            type: integer
            fits_keyword: DETXCOR
            blend_table: True
          detycor:
            title: Starting pixel in detector y-axis direction
            type: integer
            fits_keyword: DETYCOR
            blend_table: True
          detxsiz:
            title: Number of pixels in detector x-axis direction
            type: integer
            fits_keyword: DETXSIZ
            blend_table: True
          detysiz:
            title: Number of pixels in detector y-axis direction
            type: integer
            fits_keyword: DETYSIZ
            blend_table: True
      time:
        title: Time information
        type: object
        properties:
          barycentric_correction:
            title: "[s] Barycentric correction at exposure start"
            type: number
            fits_keyword: BARTDELT
            blend_table: True
          barycentric_expstart:
            title: "[d] Barycentric exposure start time in MJD"
            type: number
            fits_keyword: BSTRTIME
            blend_table: True
          barycentric_expend:
            title: "[d] Barycentric exposure end time in MJD"
            type: number
            fits_keyword: BENDTIME
            blend_table: True
          barycentric_expmid:
            title: "[d] Barycentric exposure mid time in MJD"
            type: number
            fits_keyword: BMIDTIME
            blend_table: True
          heliocentric_correction:
            title: "[s] Heliocentric correction at exposure start"
            type: number
            fits_keyword: HELIDELT
            blend_table: True
          heliocentric_expstart:
            title: "[d] Heliocentric exposure start time in MJD"
            type: number
            fits_keyword: HSTRTIME
            blend_table: True
          heliocentric_expend:
            title: "[d] Heliocentric exposure end time in MJD"
            type: number
            fits_keyword: HENDTIME
            blend_table: True
          heliocentric_expmid:
            title: "[d] Heliocentric exposure mid time in MJD"
            type: number
            fits_keyword: HMIDTIME
            blend_table: True
      ref_file:
        title: Reference file information
        type: object
        properties:
          # NOTE: R_ is for Reference
          crds:
            title: CRDS parameters
            type: object
            properties:
              sw_version:
                title: Version of CRDS file selection software used
                type: string
                fits_keyword: CRDS_VER
                blend_table: True
              context_used:
                title: CRDS context (.pmap) used to select ref files
                type: string
                fits_keyword: CRDS_CTX
                blend_table: True
          area:
            title: Pixel area reference file information
            type: object
            properties:
              name:
                title: Pixel area reference file name
                type: string
                fits_keyword: R_AREA
                blend_table: True
          bias:
            title: Bias reference file information
            type: object
            properties:
              name:
                title: Bias reference file name
                type: string
                fits_keyword: R_BIAS
                blend_table: True
          cubepar:
            title: IFU cube reference file information
            type: object
            properties:
              name:
                title: IFU cube parameters reference file name
                type: string
                fits_keyword: R_CUBPAR
                blend_table: True
          dark:
            title: Dark reference file information
            type: object
            properties:
              name:
                title: Dark reference file name
                type: string
                fits_keyword: R_DARK
                blend_table: True
          data_quality:
            title: Data quality reference file information
            type: object
            properties:
              name:
                title: Mask reference file name
                type: string
                fits_keyword: R_DQ
                blend_table: True
          distortion:
            title: Distortion reference file information
            type: object
            properties:
              name:
                title: Distortion reference file name
                type: string
                fits_keyword: R_DISTOR
                blend_table: True
          drizpars:
            title: Drizzle parameters reference file information
            type: object
            properties:
              name:
                title: Drizzle parameters reference file name
                type: string
                fits_keyword: R_DRZPAR
                blend_table: True
          extract1d:
            title: 1-D extraction parameters reference file information
            type: object
            properties:
              name:
                title: 1-D extraction parameters reference file name
                type: string
                fits_keyword: R_EXTR1D
                blend_table: True
          filteroffset:
            title: Filter Offset reference file information
            type: object
            properties:
              name:
                title: Filter Offset reference file name
                type: string
                fits_keyword: R_FILOFF
                blend_table: True
          flat:
            title: Flat field reference file information
            type: object
            properties:
              name:
                title: Flat reference file name
                type: string
                fits_keyword: R_FLAT
                blend_table: True
          dflat:
            title: Detector flat field reference file information
            type: object
            properties:
              name:
                title: DFlat reference file name
                type: string
                fits_keyword: R_DFLAT
                blend_table: True
          fflat:
            title: Fore optics flat field reference file information
            type: object
            properties:
              name:
                title: FFlat reference file name
                type: string
                fits_keyword: R_FFLAT
                blend_table: True
          sflat:
            title: Spectrograph optics flat field reference file information
            type: object
            properties:
              name:
                title: SFlat reference file name
                type: string
                fits_keyword: R_SFLAT
                blend_table: True
          gain:
            title: Gain reference file information
            type: object
            properties:
              name:
                title: Gain reference file name
                type: string
                fits_keyword: R_GAIN
                blend_table: True
          ifufore:
            title: IFU fore reference file information
            type: object
            properties:
              name:
                title: ifufore reference file name
                type: string
                fits_keyword: R_IFUFOR
                blend_table: True
          ifupost:
            title: IFU post reference file information
            type: object
            properties:
              name:
                title: ifupost reference file name
                type: string
                fits_keyword: R_IFUPOS
                blend_table: True
          ifuslicer:
            title: IFU slicer reference file information
            type: object
            properties:
              name:
                title: ifuslicer reference file name
                type: string
                fits_keyword: R_IFUSLI
                blend_table: True
          ipc:
            title: IPC reference file information
            type: object
            properties:
              name:
                title: IPC reference file name
                type: string
                fits_keyword: R_IPC
                blend_table: True
          linearity:
            title: Linearity reference file information
            type: object
            properties:
              name:
                title: Linearity reference file name
                type: string
                fits_keyword: R_LINEAR
                blend_table: True
          nrm:
            title: Non-Redundant mask reference file information
            type: object
            properties:
              name:
                title: Non-Redundant mask reference file name
                type: string
                fits_keyword: R_NRM
                blend_table: True
          pathloss:
            title: Pathloss reference file information
            type: object
            properties:
              name:
                title: Pathloss reference file name
                type: string
                fits_keyword: R_PTHLOS
                blend_table: True
          persat:
            title: Persistence saturation reference file information
            type: object
            properties:
              name:
                title: Persistence saturation reference file name
                type: string
                fits_keyword: R_PERSAT
                blend_table: True
          photom:
            title: Photometric reference file information
            type: object
            properties:
              name:
                title: Photometric reference file name
                type: string
                fits_keyword: R_PHOTOM
                blend_table: True
          psfmask:
            title: PSF mask reference file information
            type: object
            properties:
              name:
                title: PSF mask reference file name
                type: string
                fits_keyword: R_PSFMAS
                blend_table: True
          readnoise:
            title: Read noise reference file information
            type: object
            properties:
              name:
                title: Read noise reference file name
                type: string
                fits_keyword: R_READNO
                blend_table: True
          refpix:
            title: Reference pixels reference file information
            type: object
            properties:
              name:
                title: Reference pixels reference file name
                type: string
                fits_keyword: R_REFPIX
                blend_table: True
          regions:
            title: Regions reference file information
            type: object
            properties:
              name:
                title: Regions reference file name
                type: string
                fits_keyword: R_REGION
                blend_table: True
          resample:
            title: Resample processing reference file information
            type: object
            properties:
              name:
                title: Resample parameters reference file name
                type: string
                fits_keyword: R_RESAMP
                blend_table: True
          resolution:
            title: IFU resolution reference file information
            type: object
            properties:
              name:
                title: IFU resolution reference file name
                type: string
                fits_keyword: R_RESOL
                blend_table: True
          saturation:
            title: Saturation reference file information
            type: object
            properties:
              name:
                title: Saturation reference file name
                type: string
                fits_keyword: R_SATURA
                blend_table: True
          speckernel:
            title: Spectral convolution kernel reference file information
            type: object
            properties:
              name:
                title: Spectral convolution kernel reference file name
                type: string
                fits_keyword: R_SPKERN
                blend_table: True
          specprofile:
            title: Spectral profile reference file information
            type: object
            properties:
              name:
                title: Spectral profile reference file name
                type: string
                fits_keyword: R_SPPROF
                blend_table: True
          spectrace:
            title: Spectral trace reference file information
            type: object
            properties:
              name:
                title: Spectral trace reference file name
                type: string
                fits_keyword: R_SPTRAC
                blend_table: True
          specwcs:
            title: Spectral distortion reference file information
            type: object
            properties:
              name:
                title: Spectral distortion reference file name
                type: string
                fits_keyword: R_SPCWCS
                blend_table: True
          throughput:
            title: Filter throughput reference file information
            type: object
            properties:
              name:
                title: Filter throughput reference file name
                type: string
                fits_keyword: R_THRPUT
                blend_table: True
          trapdensity:
            title: Trap density reference file information
            type: object
            properties:
              name:
                title: Trap density reference file name
                type: string
                fits_keyword: R_TRPDEN
                blend_table: True
          trappars:
            title: Trap parameters reference file information
            type: object
            properties:
              name:
                title: Trap parameters reference file name
                type: string
                fits_keyword: R_TRPPAR
                blend_table: True
          wavelengthrange:
            title: Wavelength Range reference file information
            type: object
            properties:
              name:
                title: Wavelength Range reference file name
                type: string
                fits_keyword: R_WAVRAN
                blend_table: True
          wavemap:
            title: Wavelength map reference file information
            type: object
            properties:
              name:
                title: Wavelength map reference file name
                type: string
                fits_keyword: R_WAVMAP
                blend_table: True
      cal_step:
        # NOTE: This is actually all of the steps, but typically every step corresponds to a calibration step or file
        # NOTE: S_ is for Step
        title: Calibration step information
        type: object
        properties:
          assign_wcs:
            title: Assign World Coordinate System
            type: string
            fits_keyword: S_WCS
            blend_table: True
          assign_mtwcs:
            title: Assign Moving Target World Coordinate System
            type: string
            fits_keyword: S_MTWCS
            blend_table: True
          back_sub:
            title: Background subtraction
            type: string
            fits_keyword: S_BKDSUB
            blend_table: True
          badpix_selfcal:
            title: Bad Pixel Self-Calibration
            type: string
            fits_keyword: S_BPXSLF
            blend_table: True
          bias:
            title: Bias subtraction
            type: string
            fits_keyword: S_BIAS
            blend_table: True
          charge_migration:
            title: Charge Migration
            type: string
            fits_keyword: S_CHGMIG
            blend_table: True
          combine_1d:
            title: 1-D Spectral Combination
            type: string
            fits_keyword: S_COMB1D
            blend_table: True
          cube_build:
            title: IFU Cube Creation
            type: string
            fits_keyword: S_IFUCUB
            blend_table: True
          dark_sub:
            title: Dark Subtraction
            type: string
            fits_keyword: S_DARK
            blend_table: True
          dq_init:
            title: Data Quality Initialization
            type: string
            fits_keyword: S_DQINIT
            blend_table: True
          emission:
            title: Telescope Emission Correction
            type: string
            fits_keyword: S_TELEMI
            blend_table: True
          err_init:
            title: Error Initialization
            type: string
            fits_keyword: S_ERRINI
            blend_table: True
          extract_1d:
            title: 1-D Spectral Extraction
            type: string
            fits_keyword: S_EXTR1D
            blend_table: True
          extract_2d:
            title: 2-D Spectral Extraction
            type: string
            fits_keyword: S_EXTR2D
            blend_table: True
          flat_field:
            title: Flat Field Correction
            type: string
            fits_keyword: S_FLAT
            blend_table: True
          gain_scale:
            title: Gain Scale Correction
            type: string
            fits_keyword: S_GANSCL
            blend_table: True
          ipc:
            title: Interpixel Capacitance Correction
            type: string
            fits_keyword: S_IPC
            blend_table: True
          jump:
            title: Jump Detection
            type: string
            fits_keyword: S_JUMP
            blend_table: True
          linearity:
            title: Linearity Correction
            type: string
            fits_keyword: S_LINEAR
            blend_table: True
          nsclean:
            title: 1/f Noise Correction
            type: string
            fits_keyword: S_NSCLEN
          outlier_detection:
            title: Outlier Detection
            type: string
            fits_keyword: S_OUTLIR
            blend_table: True
          pathloss:
            title: Pathloss Correction
            type: string
            fits_keyword: S_PTHLOS
            blend_table: True
          persistence:
            title: Persistence Correction
            type: string
            fits_keyword: S_PERSIS
            blend_table: True
          photom:
            title: Photometric Calibration
            type: string
            fits_keyword: S_PHOTOM
            blend_table: True
          pixel_replace:
            title: Pixel Replacment
            type: string
            fits_keyword: S_PXREPL
            blend_table: True
          ramp_fit:
            title: Ramp Fitting
            type: string
            fits_keyword: S_RAMP
            blend_table: True
          refpix:
            title: Reference Pixel Correction
            type: string
            fits_keyword: S_REFPIX
            blend_table: True
          resample:
            title: Image resampling
            type: string
            fits_keyword: S_RESAMP
            blend_table: True
          saturation:
            title: Saturation Checking
            type: string
            fits_keyword: S_SATURA
            blend_table: True
          skymatch:
            title: Sky Background Equalization or Subtraction
            type: string
            fits_keyword: S_SKYMAT
            blend_table: True
          source_catalog:
            title: Source Photometry and Morphology
            type: string
            fits_keyword: S_SRCCAT
            blend_table: True
          srctype:
            title: Source Type Determination
            type: string
            fits_keyword: S_SRCTYP
            blend_table: True
          tso_photometry:
            title: TSO Imaging Photometry
            type: string
            fits_keyword: S_TSPHOT
            blend_table: True
          tweakreg:
            title: Image Alignment via Astronomical Sources
            type: string
            fits_keyword: S_TWKREG
            blend_table: True
          wavecal:
            title: Wavelength calibration
            type: string
            fits_keyword: S_WAVCAL
            blend_table: True
